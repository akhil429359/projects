{% extends 'userindex.html' %}
{% block content %}
<div class="container my-5">
    <div class="card p-4 shadow-lg border-3 rounded-4 d-flex flex-column" style="border-color:#add8e6; min-height:350px;">
        
        <h2 class="text-primary">{{ post.title }}</h2>
        
        {% if post.image %}
            <img src="{{ post.image.url }}" class="img-fluid my-3 rounded">
        {% endif %}

        <p class="fs-4 flex-grow-1">{{ post.content }}</p>

        <div class="pt-3 mt-3 d-flex justify-content-end" 
                     style="border-top:3px solid #add8e6;">
                    <div class="text-end text-dark">
                        <span style="font-weight:700;">Posted by:</span> {{ post.author.username }}  
                        <br>
                        <span style="font-weight:700;">Posted on:</span> {{ post.date|date:"F d, Y h:i A" }}
                    </div>
        </div>
    </div>
    
    <div class="mt-3 d-flex justify-content-between">
        <a href="{% url 'userpost' %}" class="btn btn-outline-primary">‚Üê Back to All Posts</a>
        <a href="{% url 'profile' request.user.id %}" class="btn btn-outline-success">My Profile</a>
    </div>

</div>
<hr style="border-top:3px solid #add8e6;">

<div class="mt-4">
    <h4 class="text-primary">Comments ({{ comments.count }})</h4>

    {% for comment in comments %}
        <div class="border rounded p-2 my-2 shadow-sm">
            <p class="mb-1"><strong class="text-danger">{{ comment.user.username }}</strong> commented:</p>
            <p>{{ comment.content }}</p>
            <small class="text-muted">{{ comment.created_at|date:"F d, Y H:i" }}</small>
        </div>
    {% empty %}
        <p class="text-muted">No comments yet. Be the first to comment!</p>
    {% endfor %}

    {% if user.is_authenticated %}
        <form method="post" class="mt-3">
            {% csrf_token %}
            {{ form.as_p }}
            <button type="submit" class="btn btn-primary">Post Comment</button>
        </form>
    {% else %}
        <p class="text-muted">You must <a href="{% url 'login' %}">log in</a> to comment.</p>
    {% endif %}
</div>
{% endblock %}
